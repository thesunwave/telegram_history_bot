# Исправление проблемы с промптом для summary

## Проблема
В промпте `SUMMARY_PROMPT` использовались плейсхолдеры типа `{chatTitle}`, `{startDate}`, `{endDate}`, `{totalMessages}`, `{participants}`, `{messages}`, но в коде не было логики для их замены на реальные значения. Это могло приводить к некорректным запросам к AI и потенциально проблематичным ответам.

## Решение

### 1. Обновлена функция `createSummaryRequest` в `src/summary.ts`
- Добавлена логика для замены плейсхолдеров на реальные значения
- Добавлены дополнительные параметры `chatId`, `start`, `end` для получения контекстной информации
- Автоматическое извлечение списка участников из сообщений
- Форматирование дат в читаемый вид

### 2. Обновлены вызовы функции
- Все вызовы `createSummaryRequest` теперь передают необходимые параметры
- Поддержка как временных диапазонов, так и запросов последних сообщений

### 3. Улучшен системный промпт в `wrangler.jsonc`
- Заменен на более нейтральный и безопасный текст
- Убраны потенциально проблематичные фразы
- Добавлены четкие инструкции по тону и формату ответа

### 4. Удален плейсхолдер `{messages}` из пользовательского промпта
- Сообщения добавляются провайдером отдельно через `MESSAGE_SEPARATOR`
- Это обеспечивает правильное форматирование запроса

## Результат
- Промпты теперь содержат реальную контекстную информацию вместо плейсхолдеров
- AI получает четкие инструкции и контекст для создания качественных сводок
- Снижен риск получения некорректных или проблематичных ответов
- Сохранена обратная совместимость с существующими конфигурациями

## Пример результата замены плейсхолдеров
```
Контекст:
- Чат: Чат 3f
- Период: 01.01.2022 - 01.01.2022
- Всего сообщений: 3
- Участников: user1, user2
```

Все тесты проходят успешно, функциональность работает корректно.